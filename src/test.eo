
(declare-const Bool Type)
(declare-const true Bool)
(declare-const false Bool)

(declare-parameterized-const eo::eq
  ((U Type :implicit))
  (-> U U Bool)
)

(declare-parameterized-const eo::ite
  ((T Type :implicit))
  (-> Bool T T T)
)



(declare-parameterized-const eo::is_var
  ((T Type :implicit))
  (-> T Bool)
)

(declare-parameterized-const eo::cons
  ((U Type :implicit) (T Type :implicit))
  (-> (-> U T T) U T T)
)

(declare-parameterized-const eo::list_concat
  ((U Type :implicit) (T Type :implicit))
  (-> (-> U T T) T T T)
)


(declare-const eo::List Type)
(declare-const eo::List::nil eo::List)
(declare-parameterized-const eo::List::cons
  ((T Type :implicit))
  (-> T eo::List eo::List)
  :right-assoc-nil eo::List::nil
)

(declare-const @@Pair (-> Type Type Type))
(define @Pair () @@Pair)
(declare-parameterized-const @@pair ((U Type :implicit) (T Type :implicit)) (-> U T (@Pair U T)))
(define @pair () @@pair)

; program: $pair_first
; args:
; - t (@Pair T S)
; return: The first element in the pair
(program $pair_first ((T Type) (S Type) (t T) (s S))
  :signature ((@Pair T S)) T
  (
  (($pair_first (@pair t s)) t)
  )
)

; program: $pair_second
; args:
; - t (@Pair T S)
; return: The second element in the pair
(program $pair_second ((T Type) (S Type) (t T) (s S))
  :signature ((@Pair T S)) S
  (
  (($pair_second (@pair t s)) s)
  )
)

(define @List () eo::List)
(define @list.nil () eo::List::nil)
(define @list () eo::List::cons)

(program $evaluate_list () :signature (@List) @List)

(program $evaluate_internal ((T Type) (t T) (tev T))
  :signature (T @List) T
  (
  (($evaluate_internal t (@list tev)) tev)
  )
)

(define $evaluate ((T Type :implicit) (t T))
  ($evaluate_internal t ($evaluate_list (@list t))))

(program $get_arg_list_rec ((T Type) (S Type) (f (-> T S)) (x T) (y S) (acc @List))
  :signature (S @List) @List
  (
    (($get_arg_list_rec (f x) acc)  ($get_arg_list_rec f (eo::cons @list x acc)))
    (($get_arg_list_rec y acc)      acc)
  )
)

(define $get_arg_list ((T Type :implicit) (t T)) ($get_arg_list_rec t @list.nil))

(program $is_app ((T Type) (S Type) (U Type) (f (-> T U)) (g (-> T S)) (h (-> T U)) (x T))
  :signature ((-> T U) S) Bool
  (
    (($is_app f (g x))  ($is_app f g))
    (($is_app f h)      (eo::eq f h))
  )
)

(program $is_var_list ((U Type) (x U) (xs @List :list))
  :signature (@List) Bool
  (
    (($is_var_list (@list x xs))  (eo::ite (eo::is_var x) ($is_var_list xs) false))
    (($is_var_list @list.nil)     true)
  )
)
