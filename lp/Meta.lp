//require open eo2lp.Core;
require open
  Stdlib.HOL
  Stdlib.List
  Stdlib.String
  Stdlib.Z
  Stdlib.Bool;

// set of all `eo` terms.
symbol eo : Set;
//sequential symbol ty : Ï„ eo â†’ TYPE;


// if we have `meta`, we can do typechecking here?
// once a term is typechecked and elaborated,
// we inject into the 'real' translated file?
symbol ITE : ð”¹ â†’ Set â†’ Set â†’ Set;

symbol ctyp : String â†’ Ï„ eo â†’ ð”¹;
//symbol catt : String â†’ Ï„;
symbol typeof : Ï„ (eo â¤³ eo);

//symbol tm (t : Ï„ eo) : ITE (ctyp ) ty (typeof t);

symbol ð’¦ : Ï„ eo;
symbol const : String â†’ Ï„ eo â†’ Ï„ eo;

symbol ty â‰” const "Type" ð’¦;
symbol b  â‰” const "Bool" (const "Type" ð’¦);

symbol var : String â†’ Ï„ eo â†’ Ï„ eo;
symbol app : String â†’ Ï„ (list eo) â†’ Ï„ eo;

symbol __ : Ï„ eo â†’ Ï„ eo â†’ Ï„ eo;
compute app "-" (var "x" b â¸¬ var "y" b â¸¬ â–¡);



// align Eunoia `Type` with `Set`.
symbol EO_TYPE â‰” const "Type" EO_KIND;
rule ty (const "Type" EO_KIND) â†ª Set;

rule ty (app "->" ($t â¸¬ â–¡))   â†ª ty $t
with ty (app "->" ($t â¸¬ $ts)) â†ª ty $t â†’ ty (app "->" $ts);

// align Eunoia `Bool` constant with `ð”¹`.
symbol EO_BOOL â‰” const "Bool" EO_TYPE;
rule ty (const "Bool" (const "Type" EO_KIND)) â†ª ð”¹;

symbol EO_INT â‰” const "Int" EO_TYPE;
rule ty (const "Int" EO_TYPE) â†ª â„¤;

compute ty
    (app "->" (EO_BOOL â¨¾ EO_BOOL â¨¾ âˆŽ));

type const "@@Pair" (app "->" (EO_TYPE â¨¾ EO_TYPE â¨¾ EO_TYPE â¨¾ âˆŽ));

type const "-" (app "->" (EO_INT â¨¾ EO_INT â¨¾ âˆŽ));
type const "-" (app "->" (EO_INT â¨¾ EO_INT â¨¾ EO_INT â¨¾ âˆŽ));


symbol _Z : â„¤ â†’ Ï„ eo;

compute
  app "-" (_Z 1 â¨¾ âˆŽ);
compute
  app "-" (_Z 2 â¨¾ _Z 2 â¨¾ âˆŽ);


// in this setup, is there any way to ask
// 'is t well typed?'

symbol ite : Ï„ eo â†’ Ï„ eo â†’ Ï„ eo â†’ Ï„ eo;
rule ite (const "true" bool) $x $y â†ª $x;






symbol eoâˆ·List â‰” const "eo::List" Type;
symbol eoâˆ·Listâˆ·nil â‰” const "eo::List::nil" Type;
symbol eoâˆ·Listâˆ·cons â‰” const "eo::List::cons" Type;

symbol !!Pair â‰” const "@@Pair" (arrow (Type â¨¾ Type â¨¾ âˆŽ));
symbol !Pair â‰” !!Pair;



symbol !List â‰” eoâˆ·List;
symbol !List_nil  â‰” eoâˆ·Listâˆ·nil;
symbol !List_cons â‰” eoâˆ·Listâˆ·cons;
